## kafka

```
1.什么是Kafka
2.什么是消息中间件
3.消息中间件的应用场景
4.Kafka优势和劣势
5.Kafka应用场景
6.kafka名词解释
  代理(Broker)
  主题(Topic)
  分区(partition)
  生产者(Producer)
  消费群组(Consumer Group)
  消费者(Consumer)
7.代理(Broker)
8.主题(Topic)
9.分区(Partition)
10.生产者(Producer)
11.消费者(Consumer)
12.参考资料

```

## 1.什么是Kafka
```
Kafka是消息中间件的一种,它是一个分布式、可分区、可复制的高性能消息系统,它提供普通消息系统的功能队列、发布订阅
Kafka使用队列模型时,它将处理工作平均分配给消费组(Consumer Group)中的消费者成员
Kafka使用发布订阅模式时,它可以将消息广播给多个消费组,也允许消息被多个消费者订阅
```

## 2.什么是消息中间件
```
消息中间件是一种异步通信协议,也可以说试一种通信软件,它可以为分布式应用、系统或者实体提供跨平台、异步、松耦合、高可靠性并且安全的通信功能
```

## 3.消息中间件的应用场景

```
1. 应用程序解耦
    比如用户注册送红包发送注册短信,传统做法是先用户注册然后送红包最后发送注册短信,
    使用消息队列用户注册成功后发送1个消息立即返回, 同时发送用户注册和送注册红包
    传统如果用户注册送红包发送注册短信分别需要用时50ms,就需要150ms=(50ms 用户注册 + 50ms 送红包 + 50ms发送注册短信)
    消息中间件用户注册成功后发送1个消息立即返回,同时发送用户注册和送注册红包,就需要100ms=(50ms 用户注册 + 50ms(送红包 + 发送注册短信))
    如果不需要发送短信,停用短信消费者即可,需要时启用短信消费者就好
    如果不需要送红包,停用送红包消费者即可,需要的启用送红包消费者就好
    从而提高吞吐量和应用解耦
    
2. 异步处理
    发送短信、发送邮件、注册送红包等

3. 流量削峰
    主要用于高并发业务场景,缓解短时间内高流量压垮应用比如秒杀和活动等,将用户请求放入消息队列中,如果消息队列成功最大数量,
    直接抛弃用户请求或跳转到错误页面
```


## 4. Kafka优势和劣势
```sh
优势:
  1.可靠性: Kafka是分布式负载均衡、分区、副本复制实现故障转移来保存可靠性.Kafka分布式的,一个数据多个副本,少数集群宕机,不会丢失数据,也不会导致不可用
  2.可扩展性: 可以通过简单的增加服务器横向扩展,无需停机
  3.持久性: Kafka消息持久化(零拷贝zero-copy)到磁盘上,副本机制实现数据沉余,保证数据不会丢失
  4.高性能: Kafka对于发布订阅订阅都具有很高吞吐量
 	单机写入TPS约在百万条/秒,即使在非常廉价的商用机器上也能做到单机支持每秒100K条消息的传输
   	零拷贝技术(sendfile zero copy)
    分布式存储
    点对点消息传递: 分区(Partition)可以在多个节点上(例如: 1个节点1个主题3分区吞吐量是300MB, 分成3个节点分别存放个主题3分区即300MB*3=900MB的吞吐量)
    磁盘顺序读顺序写
    批量读批量写
    kafka不保存消息状态,消费者通过记录主题分区中的offset表示之前的消息都被消费,offset之后的都是未消费,offset可以任意移动
        
        
缺点:
  消息乱序: Kafka只能保证单个分区(Partition)内部的消息有序,如果单个主题(Topic)有多个分区,分区之间无法保证消息有序
  重复消息: Kafka保证每条消息至少送达一次,虽然几率很小,但一条消息可能被送达多次.
  复杂性: Kafka需要Zookeeper的支持,主题(Topic)一般需要人工创建,部署和维护比一般MQ成本更高

```

## 5. Kafka应用场景?
```
1. 日志收集处理
2. 消息系统
3. 网站行为日志跟踪
4. 流式处理: 对输入数据流进行转换、聚合或汇总然后输出到某个地方,当然也可以是另一个流
5. 事件溯源
```

## 6. kafka名词解释?
```
代理(Broker): 是一个独立的Kafka服务器, 一个集群由多个Broker组成
  Broker接收来自生产者的消息保存到指定主题(Topic)中的分区(Partition)上并设置消息偏移(Offset)然后保存在磁盘上.
  Broker为消费者提供读取服务,对读取分区的请求作出响应,返回已提交到硬盘中的消息.
  单个Broker可以轻松处理上千个分区和每秒百万级消息量
  单个Broker在低延迟下也能处理支持每秒100K(上千条消息)条消息的传输

主题(Topic): 消息的类别称为Topic
  一个Broker包含一个或者多个主题(Topic)

分区(partition):消息存储的队列
  每个主题(Topic)包含一个或者多个分区(Partition)

生产者(Producer): 发送消息的客户端
  负责发送消息到指定的代理(Broker)下的主题(Topic)中的分区(Partition)

消费群组(Consumer Group): 消息消费队列称为消费组
  一个消费组(Consumer Group)可以包含一个或者多个消费者(Consumer)
  注意消费组订阅某个主题,如果该主题的中的每个分区只能有一个消费者
  比如消费者G订阅了主题T并且主题只有2个分区分别是A和B,所以主题T最多只能有2个消费者

消费者(Consumer): 读取消息的客户端
  消费者(Consumer)负责从Broker中拉取消息并处理,设置已处理的消息偏移量
```

## 7. 代理(Broker)

## 8. 主题(Topic)

## 9. 分区(Partition)

## 10. 生产者(Producer)
```sh

```

## 11. 消费者(Consumer)

## 12.参考资料
- []()
- []()
- []()
- []()
- []()